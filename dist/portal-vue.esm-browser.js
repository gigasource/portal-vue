import{inject as t,provide as e,watch as o,defineComponent as n,onMounted as r,onUpdated as a,onBeforeUnmount as l,computed as u,h as s,getCurrentInstance as p,createApp as d,reactive as i,readonly as c}from"vue";const f=Symbol("wormhole");function m(){const e=t(f);if(!e)throw new Error("\n    [portal-vue]: Injection for 'wormhole' not found. \n    Are you sure you installed the plugin with 'app.use(plugin)'?");return e}function g(t){e(f,t)}const y="undefined"!=typeof window;function h(t,e,n){n.forEach(n=>{o(()=>e[n],()=>{console.log("[portal-vue]: Prop '"+n+"' of component "+t+" is static, but was dynamically changed by the parent.\n          This change will not have any effect.")})},{flush:"post"})}function v(t,e){const n=m();function u(){const{to:o,name:r,order:a}=t;e.default?n.open({to:o,from:r,order:a,content:e.default}):s()}function s(e){n.close({to:null!=e?e:t.to,from:t.name})}r(()=>{t.disabled||u()}),a(()=>{t.disabled?s():u()}),l(()=>{s()}),o(()=>t.to,(e,o)=>{t.disabled||(o&&o!==e&&s(o),u())})}var b=n({name:"portal",props:{disabled:{type:Boolean},name:{type:[String,Symbol],default:()=>Symbol()},order:{type:Number},slotProps:{type:Object,default:()=>({})},to:{type:String,default:()=>String(Math.round(1e7*Math.random()))}},setup:(t,{slots:e})=>(h("Portal",t,["order","name"]),v(t,e),()=>t.disabled&&e.default?e.default(t.slotProps):null)});const w=(t,{slots:e})=>null==e.default?void 0:e.default();var P=n({name:"portalTarget",props:{multiple:{type:Boolean,default:!1},name:{type:String,required:!0},slotProps:{type:Object,default:()=>({})},__parent:{type:Object}},emits:["change"],setup(t,{emit:e,slots:n}){var r;t.__parent&&(r=t.__parent,p().parent=r);const a=m(),l=u(()=>{const e=a.getContentForTarget(t.name,t.multiple),o=n.wrapper,r=e.map(e=>e.content(t.slotProps)),l=o?r.flatMap(t=>t.length?o(t):[]):r.flat(1);return{vnodes:l,vnodesFn:()=>l}});return o(l,({vnodes:o})=>{const n=o.length>0,r=a.transports.get(t.name),l=r?[...r.keys()]:[];e("change",{hasContent:n,sources:l})}),()=>l.value.vnodes.length?s(w,l.value.vnodesFn):null==n.default?void 0:n.default()}});let S=0;var M=n({name:"MountingPortal",inheritAttrs:!1,props:{mountTo:{type:String,required:!0},disabled:{type:Boolean},name:{type:String,default:()=>"mounted_"+String(S++)},order:{type:Number,default:0},to:{type:String,default:()=>String(Math.round(1e7*Math.random()))},targetSlotProps:{type:Object,default:()=>({})}},setup(t,{slots:e}){h("Portal",t,["mountTo","order","name","append","multiple"]);const o=m();if(v(t,e),y){var n;const e=function(t){const e=document.querySelector(t);if(!e)throw new Error("[portal-vue]: Mount Point '"+t+"' not found in document");return e}(t.mountTo);!function(t,e,o){const n=d({render:()=>s(P,t)});n.provide(f,e),r(()=>n.mount(o)),l(()=>{n.unmount(o)})}({multiple:!0,name:t.to,__parent:null==(n=p())?void 0:n.parent},o,e)}return()=>t.disabled&&e.default?e.default():null}});function T(t=!0){const e=i(new Map),o={open:function(t){if(!y)return;const{to:o,from:n,content:r,order:a=Infinity}=t;o&&n&&r&&(e.has(o)||e.set(o,new Map),e.get(o).set(n,{to:o,from:n,content:r,order:a}))},close:function(t){const{to:o,from:n}=t;if(!o||!n)return;const r=e.get(o);r&&(r.delete(n),r.size||e.delete(o))},transports:e,getContentForTarget:function(t,o){const n=e.get(t);if(!n)return[];const r=Array.from((null==n?void 0:n.values())||[]);return o?(a=(t,e)=>t.order-e.order,r.map((t,e)=>[e,t]).sort(function(t,e){return a(t[1],e[1])||t[0]-e[0]}).map(t=>t[1])):[r.pop()];var a}};return t?c(o):o}const _=T();function j(t,e={}){var o;t.component(e.portalName||"Portal",b),t.component(e.portalTargetName||"PortalTarget",P),t.component(e.MountingPortalName||"MountingPortal",M);const n=null!=(o=e.wormhole)?o:_;t.provide(f,n)}const N=j,F=_;export{M as MountingPortal,b as Portal,P as PortalTarget,F as Wormhole,T as createWormhole,j as install,N as plugin,g as provideWormhole,m as useWormhole};
//# sourceMappingURL=portal-vue.esm-browser.js.map
